<%- include('header') %>

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card mb-4 border-0 shadow-sm">
            <div class="card-body text-center bg-light">
                <h2 class="mb-1"><%= donor.name %></h2>
                <p class="text-muted">Community Donor Profile</p>
                <div class="d-flex justify-content-center align-items-center gap-3">
                    <span class="badge bg-success fs-6"><%= reviews.length %> Reviews</span>
                    <% 
                        let total = 0;
                        reviews.forEach(r => total += r.rating);
                        let avg = reviews.length > 0 ? (total / reviews.length).toFixed(1) : "N/A";
                    %>
                    <span class="badge bg-warning text-dark fs-6">Average: <%= avg %> â˜…</span>
                </div>
            </div>
        </div>

        <h4 class="mb-3">Public Reviews</h4>

        <% if (reviews.length === 0) { %>
            <div class="alert alert-info text-center">
                This donor hasn't received any public reviews yet.
            </div>
        <% } %>

        <% reviews.forEach(review => { %>
            <div class="card mb-3 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <h5 class="card-title text-primary">Community User ðŸ‘¤</h5>
                        <span class="text-warning">
                            <%= 'â˜…'.repeat(review.rating) %><span class="text-muted"><%= 'â˜…'.repeat(5 - review.rating) %></span>
                        </span>
                    </div>
                    <h6 class="card-subtitle mb-2 text-muted" style="font-size: 0.85rem;">
                        Item: <%= review.name %> | Date: <%= review.expiryDate %>
                    </h6>
                    <p class="card-text mt-2">
                        "<%= review.reviewComment || 'No written comment.' %>"
                    </p>
                </div>
            </div>
        <% }) %>

        <div class="text-center mt-4">
            <a href="/dashboard" class="btn btn-outline-secondary">Back to Dashboard</a>
        </div>
    </div>
</div>

</body>
</html>